syntax = "proto3";

package entities;

option go_package = "github.com/rusgainew/tunduck-app-mk/proto-lib/entities";

import "dictionaries/reference_item.proto";
import "dictionaries/vat_tax_type.proto";

// InvoiceDetail представляет одну строку (позицию) в счете-фактуре.
// Содержит информацию о конкретном товаре или услуге, включаемой в счет.
//
// Каждая строка описывает:
//   - Наименование товара/услуги
//   - Количество и цену
//   - Суммы без налога, с налогом, налоговые суммы
//   - Классификацию по кодам ТНВЭД/ГКЭД
//   - Применяемые налоги (НДС, НСП)
//
// Структура позволяет правильно рассчитать и отобразить все компоненты
// стоимости товара/услуги в соответствии с налоговым законодательством.
message InvoiceDetail {
  // ID - Уникальный идентификатор строки детали в системе.
  // Первичный ключ для этой позиции в счете.
  // Генерируется системой при создании.
  // Пример: 1, 2, 3 (порядковые номера строк в счете)
  int64 id = 1;

  // InvoiceUUID - UUID счета-фактуры, к которому относится эта строка.
  // Позволяет связать деталь с конкретным счетом.
  // Пример: "550e8400-e29b-41d4-a716-446655440000"
  string invoice_uuid = 2;

  // BaseCount - Количество товара/услуги в базовых единицах измерения.
  // Число единиц, которые продаются/покупаются (могут быть дробные значения).
  // Пример: 5.5 (пять с половиной единиц товара)
  double base_count = 3;

  // Price - Цена одной единицы товара/услуги (за базовую единицу).
  // Базовая стоимость товара без налогов (обычно без НДС и НСП).
  // Используется для расчета всех остальных сумм.
  // Пример: 1000.00 (один товар стоит 1000 сомов)
  double price = 4;

  // Amount - Общая стоимость товара (цена × количество).
  // Базовая сумма без учета налогов: Amount = BaseCount × Price
  // Пример: 5500.00 (если BaseCount=5.5, Price=1000)
  double amount = 5;

  // AmountWithoutVAT - Сумма стоимости товара без НДС.
  // Может совпадать с Amount, если НДС не применяется или применяется налог на добавленную стоимость.
  // Используется для отображения в счете "Сумма без НДС".
  // Пример: 4910.71 (если от базовой суммы вычтен НДС)
  double amount_without_vat = 6;

  // AmountVAT - Сумма налога на добавленную стоимость (НДС).
  // Размер налога, который добавляется к базовой стоимости.
  // Рассчитывается как: AmountVAT = Amount × (ставка НДС / 100)
  // Пример: 589.29 (если ставка НДС 12% от суммы 4910.71)
  double amount_vat = 7;

  // AmountST - Сумма налога НСП (налог с продаж).
  // Дополнительный налог, применяемый к некоторым товарам/услугам.
  // Рассчитывается отдельно от НДС по своей ставке.
  // Пример: 0.00 (если НСП не применяется к этому товару)
  double amount_st = 8;

  // GoodsName - Полное наименование товара или оказываемой услуги.
  // Описание товара, как его воспринимает конечный пользователь.
  // Должно быть четким и полным для идентификации товара.
  // Примеры: "Портативный компьютер ASUS VivoBook 15", "Услуга консультирования, 8 часов"
  string goods_name = 9;

  // TNVEDCode - Код ТНВЭД (Таможенная номенклатура внешнеэкономической деятельности).
  // Используется для таможенной классификации товаров при импорте/экспорте.
  // Определяет применимые таможенные пошлины и налоги.
  // Формат: 10 цифр (например, "8471.30.90")
  // Может быть пусто для услуг, оказываемых внутри страны.
  string tnved_code = 10;

  // GKEDCode - Код ГКЭД (Государственный классификатор видов экономической деятельности).
  // Используется для классификации деятельности, к которой относится товар/услуга.
  // Определяет отраслевую принадлежность операции.
  // Формат: может быть различным в зависимости от классификатора
  // Может быть пусто для некоторых товаров.
  string gked_code = 11;

  // FCDNumber - Номер ГТД или другого таможенного документа происхождения.
  // Используется для товаров, ввезенных из-за границы, содержит номер их таможенной декларации.
  // Позволяет установить происхождение и таможенный статус товара.
  // Может быть пусто для отечественных товаров.
  // Пример: "КТ 0000001"
  string fcd_number = 12;

  // UnitClassification - Тип единицы измерения товара/услуги.
  // Определяет, в каких единицах измеряется количество товара.
  // Примеры кодов: "PCS" (штук), "KG" (килограмм), "M" (метр), "HOUR" (часов), "L" (литр)
  // Используется для правильного отображения и интерпретации BaseCount.
  dictionaries.ReferenceItem unit_classification = 13;

  // GoodsType - Тип товара: товар или услуга.
  // Различение между материальными товарами и нематериальными услугами.
  // Примеры кодов: "GOODS" (товар), "SERVICE" (услуга)
  // Влияет на применимость налогов и способ расчетов.
  dictionaries.ReferenceItem goods_type = 14;

  // STTaxType - Вид и ставка налога НСП (налог с продаж), если применяется.
  // Содержит информацию о налоговой ставке, которая применяется к этому товару.
  // Может быть nil, если НСП не применяется.
  // Примеры: rate="10%", name="НСП 10%" или rate="0%", name="НСП не применяется"
  dictionaries.VATTaxType st_tax_type = 15;
}
