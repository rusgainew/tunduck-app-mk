package entities

import (
	"github.com/rusgainew/tunduck-app-mk/tmp-struct/dictionaries"
)

// InvoiceDetail представляет одну строку (позицию) в счете-фактуре.
// Содержит информацию о конкретном товаре или услуге, включаемой в счет.
//
// Каждая строка описывает:
//   - Наименование товара/услуги
//   - Количество и цену
//   - Суммы без налога, с налогом, налоговые суммы
//   - Классификацию по кодам ТНВЭД/ГКЭД
//   - Применяемые налоги (НДС, НСП)
//
// Структура позволяет правильно рассчитать и отобразить все компоненты
// стоимости товара/услуги в соответствии с налоговым законодательством.
type InvoiceDetail struct {
	// ========== ИДЕНТИФИКАТОРЫ ==========

	// ID - Уникальный идентификатор строки детали в системе.
	// Первичный ключ для этой позиции в счете.
	// Генерируется системой при создании.
	// Пример: 1, 2, 3 (порядковые номера строк в счете)
	ID int64 `json:"id"`

	// InvoiceUUID - UUID счета-фактуры, к которому относится эта строка.
	// Позволяет связать деталь с конкретным счетом.
	// Пример: "550e8400-e29b-41d4-a716-446655440000"
	InvoiceUUID string `json:"invoiceUuid"`

	// ========== КОЛИЧЕСТВО И ЦЕНЫ ==========

	// BaseCount - Количество товара/услуги в базовых единицах измерения.
	// Число единиц, которые продаются/покупаются (могут быть дробные значения).
	// Пример: 5.5 (пять с половиной единиц товара)
	BaseCount float64 `json:"baseCount"`

	// Price - Цена одной единицы товара/услуги (за базовую единицу).
	// Базовая стоимость товара без налогов (обычно без НДС и НСП).
	// Используется для расчета всех остальных сумм.
	// Пример: 1000.00 (один товар стоит 1000 сомов)
	Price float64 `json:"price"`

	// Amount - Общая стоимость товара (цена × количество).
	// Базовая сумма без учета налогов: Amount = BaseCount × Price
	// Пример: 5500.00 (если BaseCount=5.5, Price=1000)
	Amount float64 `json:"amount"`

	// AmountWithoutVAT - Сумма стоимости товара без НДС.
	// Может совпадать с Amount, если НДС не применяется или применяется налог на добавленную стоимость.
	// Используется для отображения в счете "Сумма без НДС".
	// Пример: 4910.71 (если от базовой суммы вычтен НДС)
	AmountWithoutVAT float64 `json:"amountWithoutVat"`

	// AmountVAT - Сумма налога на добавленную стоимость (НДС).
	// Размер налога, который добавляется к базовой стоимости.
	// Рассчитывается как: AmountVAT = Amount × (ставка НДС / 100)
	// Пример: 589.29 (если ставка НДС 12% от суммы 4910.71)
	AmountVAT float64 `json:"amountVat"`

	// AmountST - Сумма налога НСП (налог с продаж).
	// Дополнительный налог, применяемый к некоторым товарам/услугам.
	// Рассчитывается отдельно от НДС по своей ставке.
	// Пример: 0.00 (если НСП не применяется к этому товару)
	AmountST float64 `json:"amountSt"`

	// ========== ИНФОРМАЦИЯ О ТОВАРЕ/УСЛУГЕ ==========

	// GoodsName - Полное наименование товара или оказываемой услуги.
	// Описание товара, как его воспринимает конечный пользователь.
	// Должно быть четким и полным для идентификации товара.
	// Примеры: "Портативный компьютер ASUS VivoBook 15", "Услуга консультирования, 8 часов"
	GoodsName string `json:"goodsName"`

	// TNVEDCode - Код ТНВЭД (Таможенная номенклатура внешнеэкономической деятельности).
	// Используется для таможенной классификации товаров при импорте/экспорте.
	// Определяет применимые таможенные пошлины и налоги.
	// Формат: 10 цифр (например, "8471.30.90")
	// Может быть пусто для услуг, оказываемых внутри страны.
	TNVEDCode string `json:"tnvedCode"`

	// GKEDCode - Код ГКЭД (Государственный классификатор видов экономической деятельности).
	// Используется для классификации деятельности, к которой относится товар/услуга.
	// Определяет отраслевую принадлежность операции.
	// Формат: может быть различным в зависимости от классификатора
	// Может быть пусто для некоторых товаров.
	GKEDCode string `json:"gkedCode"`

	// FCDNumber - Номер ГТД или другого таможенного документа происхождения.
	// Используется для товаров, ввезенных из-за границы, содержит номер их таможенной декларации.
	// Позволяет установить происхождение и таможенный статус товара.
	// Может быть пусто для отечественных товаров.
	// Пример: "КТ 0000001"
	FCDNumber string `json:"fcdNumber"`

	// ========== СПРАВОЧНЫЕ ДАННЫЕ (классификаторы) ==========

	// UnitClassification - Тип единицы измерения товара/услуги.
	// Определяет, в каких единицах измеряется количество товара.
	// Примеры кодов: "PCS" (штук), "KG" (килограмм), "M" (метр), "HOUR" (часов), "L" (литр)
	// Используется для правильного отображения и интерпретации BaseCount.
	UnitClassification *dictionaries.ReferenceItem `json:"unitClassification"`

	// GoodsType - Тип товара: товар или услуга.
	// Различение между материальными товарами и нематериальными услугами.
	// Примеры кодов: "GOODS" (товар), "SERVICE" (услуга)
	// Влияет на применимость налогов и способ расчетов.
	GoodsType *dictionaries.ReferenceItem `json:"goodsType"`

	// STTaxType - Вид и ставка налога НСП (налог с продаж), если применяется.
	// Содержит информацию о налоговой ставке, которая применяется к этому товару.
	// Может быть nil, если НСП не применяется.
	// Примеры: rate="10%", name="НСП 10%" или rate="0%", name="НСП не применяется"
	STTaxType *dictionaries.VATTaxType `json:"stTaxType"`
}
