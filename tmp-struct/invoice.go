package models

// Invoice представляет счет-фактуру (налоговый документ).
// Основной документ в системе электронных счетов-фактур (ЭСФ) ТУНДУК.
//
// Существует три типа счетов-фактур:
//  1. Счет-фактура на реализацию (СФ-РЕ): Поставка товаров/услуг продавцом покупателю
//  2. Счет-фактура на приобретение (СФ-ПР): Получение товаров/услуг покупателем
//  3. Корректировочный счет-фактура (КСФ): Уточнение ошибок в предыдущих счетах
//
// Счет-фактура содержит полную информацию о товарах/услугах, сторонах сделки,
// налогах, платежах и других реквизитах, необходимых для ведения учета
// в соответствии с законодательством Кыргызской Республики.
//
// Жизненный цикл документа:
//
//	Черновик → Отправлено → Одобрено/Отклонено → Подписано → (опционально: Отозвано)
type Invoice struct {
	// ========== ИДЕНТИФИКАТОРЫ И НОМЕРА ==========

	// DocumentUUID - Уникальный универсальный идентификатор документа.
	// Генерируется системой при создании документа и остается неизменным
	// на протяжении всего жизненного цикла документа.
	// Используется для однозначной идентификации в системе ТУНДУК.
	// Формат: UUID (например, "550e8400-e29b-41d4-a716-446655440000")
	DocumentUUID string `json:"documentUuid"`

	// InvoiceNumber - Номер счета-фактуры.
	// Порядковый номер документа, присваиваемый поставщиком/продавцом.
	// Может быть в формате "СФ-001", "001-2024", и т.д., в зависимости от
	// внутренней нумерации организации.
	InvoiceNumber string `json:"invoiceNumber"`

	// Number - Дополнительный номер или код документа.
	// Может использоваться для внутренней идентификации или связи с
	// другими системами (CRM, ERP и т.д.).
	Number string `json:"number"`

	// CorrectedReceiptUUID - UUID корректируемого документа.
	// Заполняется только для корректировочных счетов (КСФ).
	// Содержит UUID счета, который исправляется/корректируется.
	// Для обычных счетов пусто.
	CorrectedReceiptUUID string `json:"correctedReceiptUuid"`

	// ========== ДАТЫ И ВРЕМЕННЫЕ ДАННЫЕ ==========

	// InvoiceDate - Дата составления счета-фактуры (подписания).
	// Дата, когда документ был подготовлен и подписан.
	// Формат: ISO 8601 (YYYY-MM-DD), например "2024-01-15"
	// Может быть nil, если дата еще не установлена.
	InvoiceDate *string `json:"invoiceDate"`

	// CreatedDate - Дата создания документа в системе.
	// Системная дата, когда документ был впервые создан.
	// Обычно совпадает с InvoiceDate или немного позже (время разницы).
	// Формат: ISO 8601 (YYYY-MM-DD), например "2024-01-15"
	CreatedDate *string `json:"createdDate"`

	// DeliveryDate - Дата фактической поставки товаров/оказания услуг.
	// День, когда товары/услуги были получены покупателем.
	// Может отличаться от InvoiceDate, если есть отсрочка доставки.
	// Формат: ISO 8601 (YYYY-MM-DD), например "2024-01-20"
	// Может быть nil для услуг без физической доставки.
	DeliveryDate *string `json:"deliveryDate"`

	// CorrecteReceiptCreationDate - Дата создания корректируемого документа.
	// Для корректировочных счетов содержит дату создания оригинального счета.
	// Для обычных счетов пусто.
	// Формат: ISO 8601 (YYYY-MM-DD)
	CorrecteReceiptCreationDate *string `json:"correctedReceiptCreationDate"`

	// ========== ОСНОВНЫЕ ФИНАНСОВЫЕ И РЕКВИЗИТНЫЕ ПОЛЯ ==========

	// TotalAmount - Общая сумма счета-фактуры.
	// Включает все суммы: базовую стоимость, НДС, НСП и другие налоги.
	// Выражается в сомах Кыргызской Республики или другой валюте (см. Currency).
	// Пример: 15500.00 (15 500 сомов)
	TotalAmount float64 `json:"totalAmount"`

	// IsResident - Флаг резидентства юридического лица (продавца).
	// true: компания является резидентом Кыргызской Республики
	// false: компания является нерезидентом (иностранная компания)
	// Влияет на применение налогов и таможенных процедур.
	IsResident bool `json:"isResident"`

	// Note - Примечание/комментарий к счету-фактуре.
	// Дополнительная информация, комментарии от поставщика/продавца.
	// Может содержать условия платежа, специальные указания и т.д.
	// Необязательное поле, может быть пусто.
	Note string `json:"note"`

	// OwnedCrmReceiptCode - Код документа в системе CRM поставщика.
	// Используется для связи с внешней CRM/ERP системой.
	// Позволяет отслеживать документы в обеих системах параллельно.
	OwnedCrmReceiptCode string `json:"ownedCrmReceiptCode"`

	// ========== ДАННЫЕ ДЛЯ КОРРЕКТИРОВОЧНЫХ СЧЕТОВ ==========

	// CorrectedReceiptCode - Номер оригинального счета-фактуры.
	// Для КСФ содержит номер счета, который корректируется.
	// Для обычных счетов пусто.
	// Пример: "СФ-001" (номер счета для исправления)
	CorrectedReceiptCode string `json:"correctedReceiptCode"`

	// CorrectionReasonCode - Код причины корректировки.
	// Классификатор, определяющий причину изменения.
	// Примеры: "PRICE_ERROR" (ошибка в цене), "QUANTITY_ERROR" (ошибка в количестве)
	// Заполняется только для КСФ.
	CorrectionReasonCode string `json:"correctionReasonCode"`

	// CorrectionReasonName - Текстовое описание причины корректировки.
	// Человеческое объяснение, почему был создан корректировочный счет.
	// Примеры: "Исправление ошибки в цене товара", "Уточнение количества"
	// Заполняется только для КСФ.
	CorrectionReasonName string `json:"correctionReasonName"`

	// ========== СПЕЦИАЛЬНЫЕ ФИНАНСОВЫЕ ПОЛЯ (для налогового учета) ==========

	// IsPriceWithoutTaxes - Флаг, указывает ли базовая цена на исключение налогов.
	// true: базовая цена уже без НДС/НСП (налоги добавляются сверху)
	// false: базовая цена включает все налоги
	// Важно для правильного расчета и отображения стоимости товаров.
	IsPriceWithoutTaxes bool `json:"isPriceWithoutTaxes"`

	// OpeningBalances - Сальдо на начало периода (для специальных документов).
	// Используется в счетах по авансовым платежам, кредитам и т.д.
	// Содержит остаток на начало расчетного периода.
	OpeningBalances float64 `json:"openingBalances"`

	// AssessedContributionsAmount - Сумма начисленных взносов/платежей.
	// Используется для документов по налогам, социальным взносам и т.д.
	// Содержит сумму начисленных платежей в расчетном периоде.
	AssessedContributionsAmount float64 `json:"assessedContributionsAmount"`

	// PaidAmount - Сумма оплаченная/перечисленная.
	// Сумма уже выплаченных/перечисленных денежных средств.
	// Используется для отслеживания поступлений и платежей.
	PaidAmount float64 `json:"paidAmount"`

	// PenaltiesAmount - Сумма штрафов.
	// Денежные штрафы, наложенные в результате нарушений или просрочек.
	PenaltiesAmount float64 `json:"penaltiesAmount"`

	// FinesAmount - Сумма пени (процентные штрафы за просрочку).
	// Пени начисляются за просрочку платежа по формуле.
	FinesAmount float64 `json:"finesAmount"`

	// ClosingBalances - Сальдо на конец периода.
	// Остаток на конец расчетного периода = OpeningBalances + AssessedContributionsAmount - PaidAmount
	ClosingBalances float64 `json:"closingBalances"`

	// AmountToBePaid - Сумма к оплате/перечислению.
	// Остаток, который еще требуется оплатить или получить.
	// Обычно = ClosingBalances + PenaltiesAmount + FinesAmount
	AmountToBePaid float64 `json:"amountToBePaid"`

	// PersonalAccountNumber - Номер личного счета налогоплательщика.
	// Номер счета, присвоенный налоговым органом для этого налогоплательщика.
	// Используется для уплаты налогов и отслеживания платежей.
	PersonalAccountNumber string `json:"personalAccountNumber"`

	// ========== БАНКОВСКИЕ РЕКВИЗИТЫ ==========

	// LegalPersonBankAccount - Номер банковского счета поставщика/продавца.
	// Полный номер банковского счета, открытого в кредитном учреждении.
	// На этот счет должны поступать платежи за товары/услуги.
	// Пример: "0012000012345678901234"
	LegalPersonBankAccount string `json:"legalPersonBankAccount"`

	// ContractorBankAccount - Номер банковского счета покупателя/контрагента.
	// Счет, с которого производится платеж за товары/услуги.
	// Может быть заполнен, если известна информация о платежном счете покупателя.
	ContractorBankAccount string `json:"contractorBankAccount"`

	// ========== МЕЖДУНАРОДНЫЕ ОПЕРАЦИИ ==========

	// ExchangeRate - Курс обмена иностранной валюты к сому.
	// Используется при операциях в иностранной валюте.
	// Содержит курс, применяемый при переводе сумм в сомы.
	// Пример: 0.0119 (если счет в долларах США)
	ExchangeRate float64 `json:"exchangeRate"`

	// ForeignName - Наименование иностранной компании/контрагента.
	// Используется, когда контрагент из-за границы.
	// Содержит название иностранной организации на языке оригинала или переводе.
	ForeignName string `json:"foreignName"`

	// SellerBranchPIN - ИНН филиала/представительства поставщика.
	// Используется, если поставщик осуществляет деятельность через филиалы.
	// Содержит ИНН конкретного филиала, принимающего заказ.
	SellerBranchPIN string `json:"sellerBranchPin"`

	// ========== ДРУГИЕ РЕКВИЗИТЫ ==========

	// IsIndustry - Флаг отнесения товаров/услуг к отраслевым.
	// true: товары/услуги относятся к определенной отрасли (используется спецрежим)
	// false: обычная торговля
	IsIndustry bool `json:"isIndustry"`

	// DeliveryContractNumber - Номер договора поставки/контракта.
	// Номер основного договора, на основе которого создается счет.
	// Позволяет связать документ с контрактом/договором.
	// Пример: "ДП-2024-001"
	DeliveryContractNumber string `json:"deliveryContractNumber"`

	// DeliveryContractDate - Дата договора поставки.
	// Дата подписания основного договора поставки.
	// Формат: ISO 8601 (YYYY-MM-DD)
	DeliveryContractDate *string `json:"deliveryContractDate"`

	// ========== СПРАВОЧНЫЕ ОБЪЕКТЫ (енумерируемые значения) ==========

	// Status - Статус документа (Черновик, Отправлено, Одобрено, Отклонено, Подписано и т.д.)
	// Определяет текущее состояние документа в его жизненном цикле.
	Status *ReferenceItem `json:"status"`

	// Currency - Валюта счета-фактуры (Сом, Доллар, Евро и т.д.)
	// Валюта, в которой выражены все суммы в документе.
	Currency *ReferenceItem `json:"currency"`

	// PaymentType - Тип оплаты (Наличная, Безналичная, Кредит и т.д.)
	// Способ расчета между сторонами транзакции.
	PaymentType *ReferenceItem `json:"paymentType"`

	// ReceiptType - Тип документа/операции (Счет-фактура, Счет-фактура)
	// Классификация счета по типу операции.
	ReceiptType *ReferenceItem `json:"receiptType"`

	// DeliveryType - Вид доставки (Самовывоз, Транспортом, Почтой и т.д.)
	// Способ передачи товаров от продавца к покупателю.
	DeliveryType *ReferenceItem `json:"deliveryType"`

	// VATDelivery - Вид поставки для целей НДС (Поставка в пределах Кыргызстана, Экспорт и т.д.)
	// Определяет применимость НДС в соответствии с таможенным кодексом.
	VATDelivery *ReferenceItem `json:"vatDelivery"`

	// VATTaxType - Вид налога на добавленную стоимость и его ставка.
	// Содержит информацию о применяемой ставке НДС и ее описание.
	VATTaxType *VATTaxType `json:"vatTaxType"`

	// ========== СТОРОНЫ СДЕЛКИ ==========

	// LegalPerson - Данные поставщика/продавца (юридического лица).
	// Сторона, осуществляющая поставку товаров или оказание услуг.
	// Содержит ИНН, наименование и информацию о головной организации.
	LegalPerson *Party `json:"legalPerson"`

	// Contractor - Данные покупателя/приобретателя (контрагента).
	// Сторона, приобретающая товары или услуги.
	// Содержит ИНН, наименование и информацию о структуре.
	Contractor *Party `json:"contractor"`

	// ========== ГЕОГРАФИЧЕСКАЯ ИНФОРМАЦИЯ ==========

	// Country - Страна происхождения товаров или регистрации контрагента.
	// Используется для определения применимых налогов и таможенных процедур.
	// Особенно важна для международных операций.
	Country *Country `json:"country"`
}
